# 합의 알고리즘

합의 알고리즘은 블록체인의 비즈니스 생태계와 분산 기술을 결합하는 핵심 개념이다. 

Public 블록체인에서 분산된 노드간의 합의 과정을 통해 블록에 데이터를 저장하는데 채굴자 또는 검증자가 요구된다.

탈중앙화를 위해서는 블록체인을 검증할 참여자가 필요하고, 상호 수익을 공유하기 위한 다양한 수수료 체계가 합의 알고리즘의 핵심이다. 

---

## PoW

작업증명(PoW, Proof of Work)이란 목표값 이하의 해시를 찾는 과정을 무수히 반복함으로써 해당 작업에 참여했음을 증명하는 방식의 알고리즘이다. 

채굴을 통해 작업증명을 한다. 채굴자들은 컴퓨터로 복잡한 수식을 풀어 조건에 맞는 해시값을 찾는 과정을 반복한다. 

이 경우 모든 노드들이 찾아낸 해시값을 검증하고 승인하는 과정을 거쳐 블록에 거래 내역을 저장한다. 

따라서 모든 노드들의 승인을 거쳐야 하기 때문에 거래 내역을 속이기가 힘들다. 

이런 점에서 작업증명 합의 알고리즘은 블록체인이 가지는 탈중앙화라는 본질을 가장 잘 살린 합의 방식이다. 

> 대량의 채굴기로 컴퓨팅 자원을 가진 채굴업자들이 유리한 방식

Pros : 누구나 참여가능

Cons : 채굴에 높은 비용(장비 및 에너지 소비), Hashrate의 독점, 중앙화 문제

## PoS

지분증명(Pos, Proof of Stake)은 지분을 많이 가진 노드에게 블록을 생성할 권한을 부여한다. 

많은 지분을 가지고 있을 수록 블록에 기록할 권한이 더 많이 부여되게 된다. 

지분 증명은 블록을 생성하는 노드와 지분 생성자의 이해관계를 일치시켜 악의적인 의도로 블록을 생성하지 않도록 한다.

Pros : 많은 해시파워를 요구하지 않음(경제적 + 친환경적), 블록 생산자가 탈중앙화(안정성 확보), 블록 생성을 위해 지분이 담보로 잡혀 Dumping 방지

Cons :  보안성 검증 부재, 지분이 많은 고래 투자자들이 네트워크 독점할 가능성

## DPoS

위임지분증명(DPoS, Delegate Proof of Stake)은 PoS에서 진보된 방식이(라고 한)다. 

지분을 가진 각 노드들은 투표를 통해 트랜잭션 유효성 검사를 다른 노드에게 위임하게 되고, 위임받은 노드들이 블록 생성을 증명하는 방식이다. 

대표적인 위임지분증명 방식을 사용하는 블록체인 네트워크는 이오스(EOS)가 있다. 

위임지분증명에선 모든 노드들이 블록 생성에 참여하지 않는다. 

네트워크의 노드들이 투표를 통해 상위 노드를 선출하고 권한을 위임하게 된다.

일정 수의 상위 노드(20~21명)은 모든 권한을 위임받아 블록을 생성한다. 마치 현대 선거제도와 유사한 방식이다. 

DPoS는 합의에 참여하는 노드 수가 제한되기 때문에 빠른 성능은 물론 확장성도 갖추지만, 이러한 방식이 탈중앙화된 방식이 맞는가에 대한 논란이 있다.

Pros : 트랜잭션 처리속도 빠름, 에너지 효율 좋음, 하드포크 위험이 낮음

Cons : 상위 노드들이 담합할 위험이 있음, 상위 노드들은 공개되므로 DDoS 공격 위험에 노출됨
